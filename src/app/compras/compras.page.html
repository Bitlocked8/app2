<ion-content class="white-content">
  <!-- Barra superior / Buscador + Notificaciones -->
  <div class="top-bar" style="display:flex; align-items:center; justify-content:space-between; margin-bottom:12px;">
    <ion-searchbar [(ngModel)]="busqueda" (ionInput)="filtrarProductos()" placeholder="Buscar productos..." style="flex:1; margin-right:8px;"></ion-searchbar>
    <ion-button fill="clear" (click)="verNotificaciones()" style="position:relative;">
      <ion-icon name="notifications-outline"></ion-icon>
      <ion-badge *ngIf="notificacionesNoLeidas > 0" color="danger" style="position:absolute; top:-4px; right:-4px;">{{ notificacionesNoLeidas }}</ion-badge>
    </ion-button>
  </div>

  <ion-grid>
    <ion-row>
      <ion-col size="12" size-md="6" size-lg="4" *ngFor="let p of productosFiltrados; let i = index">
        <ion-card class="product-card animate" [style.animationDelay]="i * 100 + 'ms'" (click)="verProducto(p)">
          <div class="image-wrapper">
            <img [src]="p.imagen" alt="{{ p.nombre }}" />
          </div>
          <ion-card-header>
            <ion-card-title>{{ p.nombre }}</ion-card-title>
          </ion-card-header>
          <ion-card-content>
            <p>Capacidad: {{ p.capacidad }} {{ p.unidad }}</p>
            <p class="precio">
              ${{ p.precioReferencia }}
              <span *ngIf="p.precioReferencia2" class="oferta">${{ p.precioReferencia2 }}</span>
            </p>
            <p *ngIf="p.observaciones">{{ p.observaciones }}</p>
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>

  <ion-infinite-scroll threshold="100px" (ionInfinite)="loadData($event)">
    <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="Cargando mÃ¡s productos...">
    </ion-infinite-scroll-content>
  </ion-infinite-scroll>
</ion-content>
